<!DOCTYPE html><html lang=en-us><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="chrome=1"><meta name=HandheldFriendly content=True><meta name=MobileOptimized content=320><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content=no-referrer><base href=/ ><title>Encoding Video for Blu-ray Using H265 / AVC</title><link rel=canonical href=/guides/encoding-video-for-blu-ray-using-h264-avc/ ><style>a{color: white;}</style><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,600,600italic" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=/assets/styles/main.6329b603.css><link rel=apple-touch-icon sizes=57x57 href=/assets/images/icons/apple-touch-icon-57x57.6fd15624.png><link rel=apple-touch-icon sizes=60x60 href=/assets/images/icons/apple-touch-icon-60x60.219572b0.png><link rel=apple-touch-icon sizes=72x72 href=/assets/images/icons/apple-touch-icon-72x72.356b8147.png><link rel=apple-touch-icon sizes=76x76 href=/assets/images/icons/apple-touch-icon-76x76.0c9962ed.png><link rel=apple-touch-icon sizes=114x114 href=/assets/images/icons/apple-touch-icon-114x114.5af4b47e.png><link rel=apple-touch-icon sizes=120x120 href=/assets/images/icons/apple-touch-icon-120x120.1a3c7dee.png><link rel=apple-touch-icon sizes=144x144 href=/assets/images/icons/apple-touch-icon-144x144.9f1cf5d3.png><link rel=apple-touch-icon sizes=152x152 href=/assets/images/icons/apple-touch-icon-152x152.418b656e.png><link rel=apple-touch-icon sizes=180x180 href=/assets/images/icons/apple-touch-icon-180x180.8c12e7e2.png><link rel=icon type=image/png href=/assets/images/icons/favicon-32x32.1c10617d.png sizes=32x32><link rel=icon type=image/png href=/assets/images/icons/favicon-194x194.cf2fb803.png sizes=194x194><link rel=icon type=image/png href=/assets/images/icons/android-chrome-192x192.0f2f4b8d.png sizes=192x192><link rel=icon type=image/png href=/assets/images/icons/favicon-16x16.08453df2.png sizes=16x16><link rel=manifest href=/assets/images/icons/manifest.8913a8f2.json><link rel=mask-icon href=/assets/images/icons/safari-pinned-tab.d0455661.svg color=#5bbad5><link rel="shortcut icon" href=/assets/images/icons/favicon.d32e4619.ico><meta name=msapplication-TileColor content=#00aba9><meta name=msapplication-TileImage content=/assets/images/icons/mstile-144x144.c85a9514.png><meta name=msapplication-config content=/assets/images/icons/browserconfig.21041efe.xml><meta name=theme-color content=#ffffff><div id=wrapper><header id=header class=default><a href=/ class=logo><strong>av.community</strong> <span>all things media</span></a><nav><a href=/getting-started/ >Getting Started</a> <a href=/topics/ >Topics</a> <a href=/about/ >About</a></nav></header><div id=main class=alt><section id=one><div class=inner><header class=major><h1>Encoding Video for Blu-ray Using H265 / AVC</h1></header><p>Source: <a href="http://forum.doom9.org/showthread.php?t=154533">http://forum.doom9.org/showthread.php?t=154533</a><p>Here is part of specification that apply when encoding with H264/AVC codec, all parameters showed here are not guessing, it&rsquo;s based on original Blu-Ray specification, which are not available in public.<p>NOTE: This is discussion about settings that are for creating 100% compliant Blu-Ray structures, not for encoding from Blu-Ray sources to matroska/mp4 or other media, if you encode to those skip this nightmare :)<ol><li>GENERAL CONSTRAINTS FOR MPEG-4 H264/AVC</ol><p>1.1 ALLOWED RESOLUTIONS/FRAMERATES<p><a href=http://tom.niko.users.sbb.rs/resolutions.png>http://tom.niko.users.sbb.rs/resolutions.png</a><p>1.2 ALLOWED LEVELS, PROFILES, REFERENCE FRAMES, VBV<p>1.2.1 Primary Video Rules<p><a href=http://tom.niko.users.sbb.rs/gopsrefs2.png>http://tom.niko.users.sbb.rs/gopsrefs2.png</a><p>1.2.2 Secondary Video Rules<p>NOTE: In case of 1080 and 720 resolutions same rules apply as Primary video, while 576 and 480 resolutions have stricter parameters showed in table:<p><a href=http://tom.niko.users.sbb.rs/gopsrefs3.png>http://tom.niko.users.sbb.rs/gopsrefs3.png</a><p>1.3 SIMPLE ASPECT RATIO<p><a href=http://tom.niko.users.sbb.rs/sar.png>http://tom.niko.users.sbb.rs/sar.png</a><p>1.4 COLOR CHARACTERISTICS<p><a href=http://tom.niko.users.sbb.rs/color.png>http://tom.niko.users.sbb.rs/color.png</a><p>1.5 OTHER REQUIRED PARAMETERS<p>8-bit (4:2:0) Colorspace is only allowed Main and High profiles are allowed Maximum 3 B-Frames is allowed NAL-HRD Type 2 capable encoder is needed<ol><li>ENCODE BLU-RAY VIDEO USING x264</ol><p>2.1 MANDATORY PARAMETERS<p>Every encode for Blu-Ray must contain this parameters, without it will not meet Blu-Ray specification.<p>&ndash;bluray-compatEnforce x264 to create BD compliant stream, that will reduce x264 settings to BD compatible: bframe&lt;=3, ref&lt;=4 for 1080, ref&lt;=6 for 720/576/480, bpyramid&lt;=strict, weightp&lt;=1, aud=1, nalhrd=vbr<p>&ndash;levelBlu-Ray level, see the table for the appropriate level<p>&ndash;keyintMaximum number displayed pictures in GOP. If you set Maximum bitrate less or equal to 15mbps you can use 2 second long GOP otherwise, 1 second GOP must be used.<p>&ndash;vbv-maxrateMaximum allowed bitrate. Depend of destination media, for normal BD Media, maximum settings is allowed (40000), while for DVD Media (eg BD-5 or BD-9) there is no maximum per Blu-Ray specification, but is strongly recommended that use less or equal to 15000, since DVD reading is slower.<p>&ndash;vbv-bufsizeMaximum allowed buffer, buffer size is in relation with maxrate. Since STD Buffer Delay for Blu-Ray allows maximum 1 second. This mean to divide buffer with maxrate and see if result is less or equal to 1, if not, buffer is need to be reduced to lower value that meet 1 second STD. For BD media, maximum settings is allowed (30000), but if not meet STD Buffer Delay, then need to be reduced to lower value. For DVD media there is no maximum in Blu-Ray specification, but is strongly recommended that use less or equal to 15000, and again need to meet STD delay of 1 second.<p>For example:<p>&ndash;vbv-bufsize 30000 &ndash;vbv-maxrate 40000 is allowed &ndash;vbv-bufsize 30000 &ndash;vbv-maxrate 30000 is allowed &ndash;vbv-bufsize 15000 &ndash;vbv-maxrate 30000 is allowed &ndash;vbv-bufsize 30000 &ndash;vbv-maxrate 15000 is not allowed (delay is greater than 1 second)<p>Basicly vbv-bufsize should newer been greater than vbv-maxrate, that is whole point.<p>&ndash;sar Simple Aspect Ratio, must present in stream, see the table for the appropriate settings<p>&ndash;slices Only when encoding with &ndash;level 4.1, slices need to be set to 4 or greater, otherwise you can skip this setting or set it to 1.<p>-o xxx.264 Output file must be in raw 264 elementary stream (extension .264) otherwise settings will not applied correctly. DO NOT USE MKV OR MP4.<p>2.2 OPTIONAL PARAMETERS<p>This parameters is optional and not need for every encode.<p>&ndash;colorprim &ndash;transfer &ndash;colormatrix Specify color primaries, transfer characteristics and color matrix. This is optional, and not need to be present, see the table for the appropriate settings.<p>&ndash;pic-struct Need only when fake interlaced is used, and it&rsquo;s default on with interlaced and pulldown. It&rsquo;s fine with progressive aslo, and some BD verification tools request to be present in stream.<p>&ndash;open-gop Use non-IDR pictures instead classic IDR picture, this will tend to resolve pulsing picture problem that is usually came with short GOP&rsquo;s.<p>&ndash;fake-interlaced Since 25p or 30p video is not allowed for Primary Video, encoding progressive video that meet Blu-Ray specification is only possible with this option. If use this option you aslo need to specify &ndash;pic-struct<p>&ndash;qpfileNeed for chapters.<p>2.2 EXAMPLES<p>Progressive<p>1080p (<a href=http://www.x264bluray.com/home/1080i-p>http://www.x264bluray.com/home/1080i-p</a>) 720p (<a href=http://www.x264bluray.com/home/720p-encoding>http://www.x264bluray.com/home/720p-encoding</a>) 576p (<a href=http://www.x264bluray.com/home/576p-pal>http://www.x264bluray.com/home/576p-pal</a>) 480p (<a href=http://www.x264bluray.com/home/480p-ntsc>http://www.x264bluray.com/home/480p-ntsc</a>)<p>Interlaced<p>1080i (<a href=http://www.x264bluray.com/home/1080i>http://www.x264bluray.com/home/1080i</a>) 576i (<a href=http://www.x264bluray.com/home/576i-pal>http://www.x264bluray.com/home/576i-pal</a>) 480i (<a href=http://www.x264bluray.com/home/480i-ntsc>http://www.x264bluray.com/home/480i-ntsc</a>)<ul id=tags><li><a href=/tags/h264>h264</a><li><a href=/tags/bluray>bluray</a></ul></div></section></div><section id=contact><div class=inner><section><form method=post action=#><div class="field half first"><label for=name>Name</label><input name=name id=name></div><div class="field half"><label for=email>Email</label><input name=email id=email></div><div class=field><label for=message>Message</label><textarea name=message id=message rows=6></textarea></div><ul class=actions><li><input type=submit value="Send Message" class=special><li><input type=reset value=Clear></ul></form></section><section class=split><section><div class=contact-method><span class="icon alt fa-envelope"></span><h3>Email</h3><a href=mailto:jacobwgillespie@gmail.com>jacobwgillespie@gmail.com</a></div></section><section><div class=contact-method><span class="icon alt fa-phone"></span><h3>Phone</h3><span>(000) 000-0000 x12387</span></div></section><section><div class=contact-method><span class="icon alt fa-home"></span><h3>Address</h3><span>1234 Somewhere Road #5432<br>Nashville, TN 00000<br>United States of America</span></div></section></section></div></section><footer id=footer><div class=inner><ul class=copyright><li>&copy; 2017 Jacob Gillespie<li><a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/ >License</a>.<li><a href=mailto:jacobwgillespie@gmail.com>Contact</a><li>You can <a href=https://github.com/av-community/av.community>contribute to this website</a></ul></div></footer></div><script src=/assets/scripts/main.min.b1bc5015.js></script>